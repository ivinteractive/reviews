function hoverStar(e){if(this.index>=activeStars)for(var t=activeStars>0?activeStars:0;t<=this.index;t++)starRatings[t].className="mouseover"==e.type?"hover":"";else if("mouseover"==e.type)for(var r=activeStars-1;r>this.index;r--)starRatings[r].className="";else if("mouseleave"==e.type)for(var a=0;a<activeStars;a++)starRatings[a].className="hover"}function clickStar(e){activeStars-=1;for(var t=activeStars>this.index?activeStars:this.index,r=0;r<=t;r++)starRatings[r].className=this.index!=activeStars&&r<=this.index?"hover":"";activeStars=document.querySelectorAll("#star-ratings star.hover").length,document.querySelector("#selected-rating span").innerHTML=activeStars,document.getElementById("rating").value=activeStars}function formSubmit(e){e.preventDefault();var t=this,r=t.querySelector('input[name="display"]');t.classList.contains("display-form")&&r.setAttribute("value","0"==r.value?"1":"0");var a=getFormData(t);reqwest({url:t.action,method:t.method,type:"json",data:a,success:function(e){console.log(e.errors),e.errors&&Object.keys(e.errors).length>0&&(setErrors(t,e.errors),trackEvent("Negative Feedback Form","Form Submit",campaign_title,"0")),e.message&&0==e.errors.length&&(document.getElementById("wrapper").innerHTML=e.message,trackEvent("Negative Feedback Form","Form Submit",campaign_title,"1")),e.display&&(t.querySelector("button").className="1"==r.value?"added":"")},error:function(e){console.log(e)}})}function getFormData(e){var r=["INPUT","TEXTAREA","SELECT"],a={};for(t=0;t<r.length;t++)for(var i=e.getElementsByTagName(r[t]),n=0;n<i.length;n++)a[i[n].name]=i[n].value;e.querySelector('[name="_submit"]')&&(a._submit=e.querySelector('[name="_submit"]').value);var o=(new Date).getTime();return a.c_time=(o-loadTime)/1e3<7?1:0,a}function grabToken(e){var t=(new Date).getTime();reqwest({url:"/token-gen/"+e.id+"?_="+t,method:"GET",type:"json",success:function(t){e.querySelector('[name="_submit"]').value=t.token,e.querySelector("#token").value=randomString(t.token)},error:function(e){console.log(e)}})}function randomString(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",r=5,a="",i=0;i<r;i++){var n=Math.floor(Math.random()*t.length);a+=t.substring(n,n+1)}return e+a}function setErrors(e,t){for(var r=e.querySelectorAll(".error"),a=0;a<r.length;a++)r[a].className=r[a].className.replace(" error","");for(var i in t){var n=e.querySelector('[name="'+i+'"]');n&&(n.parentNode.className+=" error")}}function trackEvent(e,t,r,a){a="undefined"!=typeof a?a:"0","undefined"==typeof ga?console.log(r):"ga"in window&&(tracker=ga.getAll()[0],tracker&&tracker.send("event",e,t,r,a))}var $_GET={};if(document.location.toString().indexOf("?")!==-1)for(var query=document.location.toString().replace(/^.*?\?/,"").replace(/#.*$/,"").split("&"),i=0,l=query.length;i<l;i++){var aux=decodeURIComponent(query[i]).split("=");$_GET[aux[0]]=aux[1]}console.log(campaign_title);var starRatings=document.querySelectorAll("#star-ratings star"),activeStars=0;if(starRatings.length>0)for(var i=0;i<starRatings.length;i++)starRatings[i].index=i,starRatings[i].addEventListener("mouseover",hoverStar),starRatings[i].addEventListener("mouseleave",hoverStar),starRatings[i].addEventListener("click",clickStar);for(var links=document.querySelectorAll("a:not(#external-review-link)"),i=0;i<links.length;i++)links[i].addEventListener("click",function(e){trackEvent("Outbound Link","Link Click",e.currentTarget.innerText,"0")});var externalReviewLink=document.getElementById("external-review-link");externalReviewLink&&externalReviewLink.addEventListener("click",function(e){var t=""!==$_GET.link_id&&"[link_id]"!==$_GET.link_id?$_GET.link_id:"texas-medical-center-google";trackEvent("Exit To Review Site","CTA Button Click",t,"0")});var loadTime=(new Date).getTime(),reviewsForm=document.getElementById("reviews-form");reviewsForm&&(grabToken(reviewsForm),reviewsForm.addEventListener("submit",formSubmit));var reviews=document.querySelectorAll("#reviews-list form");if(reviews.length>0)for(var i=0;i<reviews.length;i++)reviews[i].addEventListener("submit",formSubmit);